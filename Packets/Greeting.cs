using System;
using System.Collections.Generic;
using System.IO;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace MongoSQL.Packets
{
    public static class Greeting
    {
        private static byte[] greetingPacket = {
                     // Offset 0x00000000 to 0x00000109
	0x6A, 0x00, 0x00, 0x00, 0x0A, 0x35, 0x2E, 0x35, 0x2E, 0x35, 0x2D, 0x31,
    0x30, 0x2E, 0x33, 0x2E, 0x32, 0x35, 0x2D, 0x4D, 0x6F, 0x6E, 0x67, 0x6F,
    0x53, 0x51, 0x4C, 0x2D, 0x41, 0x6C, 0x70, 0x68, 0x61, 0x2D, 0x30, 0x2E,
    0x31, 0x32, 0x2E, 0x33, 0x34, 0x2E, 0x31, 0x00, 0x92, 0x00, 0x00, 0x00,
    0x7E, 0x77, 0x5C, 0x45, 0x25, 0x28, 0x36, 0x79, 0x00, 0xFE, 0xF7, 0x2D,
    0x02, 0x00, 0xBF, 0x81, 0x15, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07,
    0x00, 0x00, 0x00, 0x7E, 0x2E, 0x68, 0x42, 0x50, 0x4D, 0x71, 0x6F, 0x5C,
    0x5F, 0x49, 0x30, 0x00, 0x6D, 0x79, 0x73, 0x71, 0x6C, 0x5F, 0x6E, 0x61,
    0x74, 0x69, 0x76, 0x65, 0x5F, 0x70, 0x61, 0x73, 0x73, 0x77, 0x6F, 0x72,
    0x64, 0x00};

        private static byte[] authokPacket = {// Offset 0x00000000 to 0x00000010
                 0x07, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00};

        private static byte[] versionPacket = {// Offset 0x00000000 to 0x00000010
                 0x07, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00};

        public static void SendGreeting(NetworkStream netstream)
        {
            var binaryWriter = new BinaryWriter(netstream);
            PacketRouter.WritePackets(netstream, greetingPacket);
            Thread.Sleep(1);
            PacketRouter.WritePackets(netstream, authokPacket);
            Thread.Sleep(1);
            PacketRouter.WritePackets(netstream, versionPacket);
        }
    }
}